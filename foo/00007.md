---
title: "쿠버네티스 기본 개념과 구성 요소 정리"
categories: ["Kubernetes", "Cloud Native", "DevOps"]
tags: ["kubernetes", "pod", "node", "control-plane", "data-plane", "container", "orchestration"]
---

### 리소스 생성 흐름

1. 사용자가 애플리케이션 배포 설정 작성 (deployment.yaml)
2. `kubectl apply -f deployment.yaml`을 실행하여 API 요청으로 변환
3. kube-apiserver가 API 요청을 받아 유효성 검사를 하고, 인증/인가를 거친뒤 etcd에 저장
4. Deplyment Controller가 etcd 변경을 감지하고, 필요한 Pod 리소스를 생성
5. Scheduler가 새 Pod가 실행될 최적의 Node를 선택
6. 해당 Node의 kubelet이 Pod 실행 지시를 수신하고, 컨테이너 런타임을 호출함
7. Container Runtime이 실제로 컨테이너 이미지를 Pull받아 컨테이너를 실행

> 쿠버네티스 리소스: 쿠버네티스가 관리하는 모든 대상(Pod, Deployment, Service 등)

---

## 파드위에 띄우는 서비스, 노드위에 올리는 세상

- 쿠버네티스의 모든 애플리케이션은 파드 형태로 실행
- 파드는 노트위에서 동작
- 즉, 파드와 노드는 쿠버네티스의 실제 동작 구조를 구성하는 가장 기본적인 단위

<img width="500" height="400" alt="스크린샷 2025-09-01 오후 10 21 12" src="https://github.com/user-attachments/assets/a1afef80-bf07-4c9b-acfc-1063611bab97" />

### 파드 (Pod)

- 파드는 쿠버네티스가 애플리케이션을 실행하고 관리하는 가장 작은 기본 단위임
- 쿠버네티스의 모든 애플리케이션은 반드시 파드 형태로 실행되며, 노드위에서 동작함
- 즉, 파드는 컨테이너를 담고 관리하는 기본 그릇

- 하나의 파드에는 하나 이상의 컨테이너가 포함될 수 있음
  - 일반적으로 하나의 컨테이너만 포함하지만, 밀접하게 연관된 여러 컨테이너를 한 파드에 묶어 배포하기도 함
- 파드 내부의 컨테이너들은 같은 네트워크와 공유 저장소(Volumn)을 사용하므로 서로간의 통신과 데이터 공유가 용이함

- 컨테이너는 단독으로도 실행할 수 있지만 쿠버네티스에서는 직접 컨테이너를 관리하지 않고 파드 단위로 관리함
- 파드는 쿠버네티스가 제어할 수 있는 최소 단위이며 다음과 같은 작업이 가능함
  - 배포: 파드는 쿠버네티스가 배포 가능한 대상이 됨
  - 네트워킹: 같은 파드안의 컨테이너들은 단일 IP를 공유하고 localhost로 통신이 가능함
  - 저장소 공유: 같은 파드안의 컨테이너들이 볼륨을 공유해 데이터를 주고받을 수 있음
  - 모니터링/자동복구: Liveness/Readiness Probe(컨테이너 헬스체크: 살아있는지/요청받을 준비가 됐는지를 확인)로 상태를 점검하고 이상 시 자동으로 조치함

**파드의 구성요소**

파드는 단순히 컨테이너 하나를 실행하는 것이 아니라 컨테이너 안정적으로 동작하도록 네트워크와 (필요 시) 네트워크를 함께 구성할 수 있는 실행 단위임

- 컨테이너:
  - 하나 이상의 컨테이너가 포함될 수 있음
  - 가장 흔한 형태는 하나의 컨테이너만 포함된 단일 컨테이너 파드이지만, 서로 밀접하게 연관된 여러 컨테이너를 한 파드로 묶어 하나의 작업 단위로 실행할 수 있음
- 네트워크:
  - 쿠버네티스에서 한 파드 내부의 모든 컨테이너는 동일한 네트워크 네임스페이스를 공유함
  - 따라서, 같은 IP, PORT를 함께 쓰고 서로를 localhost로 바로 호출할 수 있음
- 스토리지(볼륨):
  - 파드를 생선한다고 해서 스토리지가 자동으로 제공되지는 않음
  - 필요할 경우 여러 컨테이너 하나의 디스크 영역을 공유하도록 할 수 있음
  - 이렇게 하면 컨테이너간 데이터 교환이나 로그 파일 공유가 가능해짐

> 중요!<br/>
> 파드는 일회성이고 쉽게 사라질 수 있음.<br/>
> 따라서, Deployment, Job, StatefulSet과 같은 워크로드 리소스를 사용하고, 이 리소스들이 파드를 대신 관리해주는 관리자 역할을 함
> <br/>
> 즉, 파드는 쿠버네티스가 컨테이너를 실행하기 위해 사용하는 단위이지만 상위 리소스를 통해 간접적으로 생성하는 것이 일반적이고, 이러한 이유는 파드가 죽더라도 자동으로 다시 생성되기 때문임

- 파드는 일회성 객체이다.
  - 즉, 클러스터에서 문제가 발생해 파드가 죽거나 삭제되면 쿠버네티스는 해당 파드를 다시 생성하지 않음



### 노드 (Node)

- 쿠버네티스에서 노드는 파드를 실제로 실행하는 물리 또는 가상 머신임
- 하나의 노드에는 여러 개의 파드가 배치될 수 있으며, 각 노드는 Control Plane에 의해 관리되며 클러스터의 일부로 동작함

**노드의 구성 요소**

- kublet:
  - 모든 노드안에서 실행되는 에이전트.
  - kube-apiserver 지시에 따라 파드를 생성, 삭제하고 상태를 확인하면서 Controler Plan에 보고함
- Container Runtime:
  - 실제 컨테이너를 실행하는 프로그램.
  - ex) containerd, CRI-O (과거에는 Docker도 사용했음)
- kube-proxy:
  - 네트워크 트래픽을 볼바른 파드로 전달하는 네트워크 프록시
  - "이 요청은 어느 파드로 가야한다"라는 안내자 역할을 함

### Control Plane, Data Plane

- Control Plane은 클러스터 전체를 제어하는 두뇌 역할을 하고, Data Plane은 애플리케이션이 실제 실행되는 공간임
- Control Plane에는 앱 Pod가 올라가지 않고 오직, 제어 관련 컴포넌트(Pod 형태)가 실행됨.
- 반면, Data Plane에는 실제 웹서비스, API 서버 등 사용자의 애플리케이션 파드가 배포됨

### 파드와 노드의 관계

- 사용자가 kubectl이나 API를 통해 파드를 생성하면 쿠버네티스가 자동으로 Data Plane 중 하나를 선택해 배치함
- 이 과정을 Control Plane의 kube-scheduler가 담당함

---

## 궁금한 점

- Fargate 기반 EKS는 Pod 단위(vCPU/Memory)로 과금이 되면 파드수가 많아질수록 비용이 증가됨
  - 마이크로 서비스라고 가정하고 여러개의 서비스가 있다면 하나의 파드에 하나의 서비스만 띄우나?
  - 두 대 이상 가용성을 보장한다라고 했을때 노드도 EC2이기 때문에 언제든 죽을 수 있음. 따라서 이러한 경우에 두 대의 노드를 상시 운용되도록 클러스터를 운용해야 하나?
