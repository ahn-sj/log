---
title: "쿠버네티스 기본 개념과 구성 요소 정리"
categories: ["Kubernetes", "Cloud Native", "DevOps"]
tags: ["kubernetes", "container", "orchestration", "deployment", "scaling", "cloud"]
---

사용자는 어떤 상태로 만들고 싶은지에 대한 선언적 명세를 정의하면 쿠버네티스가 이를 유지함

### 쿠버네티스를 왜 쓰는것인가

컨테이너는 애플리케이션 실행에 최적화되어 있지만 운영함에 있어 고민해야 할 과제들이 있음

- 서버 한 대가 다운되었을때 컨테이너를 어디서 다시 띄울것인가
- 트래픽이 증가하면 컨테이너를 얼마나, 어디에 더 늘릴것인가
- 서비스 중단없이 새로운 버전을 배포

쿠버네티스는 이러한 문제를 해결하기 위해 컨테이너의 배포, 확장, 복구를 자동화하고 무중단 배포를 지원함<br/>
이처럼 쿠버네티스는 컨테이너 실행만을 하는 도구가 아닌 자동 복구, 자동 확장, 선언형 배포, 스토리지 연결 등을 자동화된 방식으로 처리함

|기능|설명|관련 리소스|
|---|---|---|
|서비스 디스커버리와 로드밸런싱|DNS/IP 기반 자동 연결 및 로드밸런싱| Service,CoreDNS|
|스토리지 오케스트레이션|스토리지 자동 마운트|PV, PVC, StorageClass |
|자동 롤아웃 및 롤백| 선언형 상태 기반 업데이트|Deplyment, ReplicaSet|
|자동 자원 할당| 최적의 컨테이너 배치| Scheduler, Requests/Limits|
|셀프 힐링| 컨테이너 자동 복구 | Liveness/Readiness Probe|
|시크릿 및 설정 관리| 민감 정보의 안전한 관리| Secret, ConfigMap|
|배치 작업 및 CI 지원| 일회성 및 반복 작업| Job, CronJob|
|수평 확장|자동 또는 수동 확장 지원| HPA, Metrics Server|
|IPv4/Ipv6 지원|Dual Stack 구성 지원| Network Plugin|
|확장성| 사용자 정의 리소스 확장| CRD, Webhook, Operator|

### 쿠버네티스의 구성

- 쿠버네티스 클러스터는 컨트롤 플레인(Control Plane)과 데이터 플레인(Data Plane, = Node)으로 구성됨
- 컨트롤 플레인은 API 서버, 스케줄러, 컨트롤러 매니저, etcd 등 관리 컴포넌트가 실행됨
  - 애플리케이션(Pod)은 이곳에서 실행하지 않고 클러스터의 상태를 감시, 조정하여 원하는 상태(Desired State)를 유지함
- 데이터 픒레인은 애플리케이션이 동작하는 영역으로 웹 서버, 데이터베이스, 백엔드 API 서버, 배치 작업 등의 컨테이너가 실행됨
- 즉, 컨트롤 플레인이 지휘소 역할을 하고 데이터 플레이 실제 실행을 담당하는 워커의 역할을 함

### 데이터 플레인의 구성 요소

|컴포넌트|역할|
|---|---|
|kublet|API 서버 지시대로 파드를 생성, 시작, 중지하고 상태를 주기적으로 보고|
|kube-proxy|서비스와 파드간 트래픽 라우팅 및 로드밸런싱 수행|
|Container Runtime|컨테이너를 실제로 실행 (ex. containerd, CRI-O 등)|

### 쿠버네티스 제어

- 쿠버네티스는 API 중심 플랫폼으로 모든 리소스는 'API Object'라는 개념으로 관리됨
- 사용자가 컨테이너를 직접 실행하거나 서버에 접속하는 것이 아닌 쿠버네티스 API 서버에게 '리소스 생성해줘'라고 요청하는 방식
  - kubectl CLI: 쿠버네티스 리소스를 생성, 수정, 삭제할때 사용되는 CLI
  - REST API 호출
  - 클라이언트 SDK 사용
 
### kube-apiserver

- kubectl, Helm, CI/CD 파이프라인 등 모든 외부 요청은 이 API 서버를 거침. 즉, 모든 작업 흐름이 여기서 출발함
- 주요 역할
  - 요청을 받아 인증/인가 처리
  - etcd에 상태 저장: 클러스터의 모든 리소스 상태를 저장하고 갱신함
  - 적절한 컨트롤러에 전달
    - 스케줄러나 컨트롤러 매니저같은 컴포넌트에 요청을 보내 실제 동작이 수행되도록 함
- 
