---
title: "파이썬 UoW 패턴과 Active Record 패턴"
tags: ["python", "django", "uow", "unit-of-work", "active-record", "orm", "domain-driven-design", "architecture"]
categories: ["python", "architecture"]
---

우연히 파이썬 리서치를 하던 도중에 UoW(Unit Of Work) 패턴이라는 것을 알게 되었다.

잠깐의 검색를 통해 이해한 점은, 도메인 모델(여기에서는 자바 기준으로 POJO를 의미함)과 영속 기능을 분리하는 것이 주 목적이라고 한다<br/>
다만, 여기서 혼동이 되었던 점은 Django의 ORM은 [`Active Record`](https://www.martinfowler.com/eaaCatalog/activeRecord.html)패턴의 ORM이라는 점이다.

내 관점에서는 관심사의 분리를 중요시하는 스프링을 한 입장에서는 UoW 패턴이 더 익숙하다.<br/>
그랬을때 스프링에서 느꼈던 장점들은,

1. 인터페이스(추상화)를 만들어 느슨한 결합을 만들면 구현체의 변경에 용이하다
2. 계층이 분리되어 '의존하는 것'이 줄어들어 테스트 준비가 쉬워진다
3. 외부 리소스(DB, Redis 등)와도 격리시킬 수 있기 때문에 테스트 용이성이 올라간다

근데 장고는 DI 프레임워크가 아니라는 점에서 그만한 의미를 가질까..는 잘 모르겠다.

레딧에도 이와 비슷한 글이 있는데 결국 트레이드 오프 관계이지만 대부분 Active Record 패턴을 써도 무방하다는 분위기다.<br/>
(물론, 5년전의 내용이고 바뀌었을수도 있다)

[ORM vs ORM + Repository Pattern](https://www.reddit.com/r/django/comments/d0596f/orm_vs_orm_repository_pattern/)

Cosmic Python 이라는 책에서 UoW(Repository Pattern 라고도 불러도 될 듯)과 Active Record 패턴을 정리한 내용도 있는 것 같아서 각 특징과 장단점을 읽기 좋은듯

- [UoW Pattern](https://www.cosmicpython.com/book/chapter_06_uow.html)
- [Active Record Pattern](https://www.cosmicpython.com/book/chapter_02_repository.html)

> 그리고 파이썬을 사용하는 버즈빌이라는 회사에서도 도메인 이벤트 관리적인 측면에서 발표한 내용이 있어서 나중에 읽어보자
> https://tech.buzzvil.com/seminar/tech-weekly-async-cosmic-python/

그래서 내가 내린 결론은, <br/>
팀 내의 컨벤션이 있다면 그걸 따르고 나중에 분리해야 할 필요성이 느껴질때 고민해봐도 늦지 않겠다는 생각이다.
